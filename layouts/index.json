{{- $pages := slice -}}
{{- range .Site.RegularPages -}}
  {{- $links := slice -}}
  {{- $content := .RawContent -}}
  
  {{- /* Find markdown links [text](url) */ -}}
  {{- $markdownLinks := findRE `\[([^\]]+)\]\(([^\)]+)\)` $content -}}
  {{- range $markdownLinks -}}
    {{- /* Extract the link text which should be the page title */ -}}
    {{- $linkText := replaceRE `\[([^\]]+)\]\(([^\)]+)\)` "$1" . -}}
    
    {{- /* Try to find the target page by title */ -}}
    {{- $targetPage := false -}}
    {{- range site.RegularPages -}}
        {{- if eq .Title $linkText -}}
            {{- $targetPage = . -}}
            {{- break -}}
        {{- end -}}
    {{- end -}}
    
    {{- /* If found, add to links */ -}}
    {{- if $targetPage -}}
        {{- $links = $links | append $targetPage.Title -}}
    {{- end -}}
  {{- end -}}
  
  {{- $pageData := dict "id" .Title "url" .RelPermalink "status" (.Params.status | default "seeding") "type" .Params.type "links" $links -}}
  {{- $pages = $pages | append $pageData -}}
{{- end -}}
{{- $pages | jsonify -}}
